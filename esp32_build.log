Processing esp32-s3-devkit-1 (platform: espressif32 @ 6.6.0; board: esp32-s3-devkitc-1; framework: arduino)
--------------------------------------------------------------------------------
Platform Manager: Installing espressif32 @ 6.6.0
Downloading 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100%
Unpacking 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100%
Platform Manager: espressif32@6.6.0 has been installed!
Tool Manager: Installing espressif/toolchain-xtensa-esp32s3 @ 8.4.0+2021r2-patch5
Downloading 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100%
Unpacking 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100%
Tool Manager: toolchain-xtensa-esp32s3@8.4.0+2021r2-patch5 has been installed!
Tool Manager: Installing espressif/toolchain-riscv32-esp @ 8.4.0+2021r2-patch5
Downloading 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100%
Unpacking 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100%
Tool Manager: toolchain-riscv32-esp@8.4.0+2021r2-patch5 has been installed!
Tool Manager: Installing platformio/framework-arduinoespressif32 @ ~3.20014.0
Downloading 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100%
Unpacking 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100%
Tool Manager: framework-arduinoespressif32@3.20014.231204 has been installed!
Tool Manager: Installing platformio/tool-esptoolpy @ ~1.40501.0
Downloading 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100%
Unpacking 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100%
Tool Manager: tool-esptoolpy@1.40501.0 has been installed!
Library Manager: Installing h2zero/NimBLE-Arduino @ ^1.4.1
Downloading 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100%
Unpacking 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100%
Library Manager: NimBLE-Arduino@1.4.3 has been installed!
Library Manager: Installing nanopb/Nanopb @ ^0.4.7
Downloading 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100%
Unpacking 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100%
Library Manager: Nanopb@0.4.91 has been installed!
Library Manager: Installing adafruit/Adafruit DotStar @ ^1.2.5
Downloading 0% 10% 20% 30% 40% 50% 60%
Unpacking 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100%
Library Manager: Adafruit DotStar@1.2.5 has been installed!
Library Manager: Resolving dependencies...
Library Manager: Installing Adafruit BusIO
Downloading 0% 10% 20% 30%
Unpacking 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100%
Library Manager: Adafruit BusIO@1.17.4 has been installed!
Library Manager: Installing esphome/ESPAsyncWebServer-esphome @ ^3.1.0
Downloading 0% 10% 20% 30% 40% 50% 60% 70% 80%
Unpacking 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100%
Library Manager: ESPAsyncWebServer-esphome@3.4.0 has been installed!
Library Manager: Resolving dependencies...
Library Manager: Installing esphome/AsyncTCP-esphome
Downloading 0% 10% 20% 30%
Unpacking 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100%
Library Manager: AsyncTCP-esphome@2.1.4 has been installed!
Library Manager: Installing bblanchon/ArduinoJson @ ^6.21.3
Downloading 0% 10% 20% 30% 40% 50% 60% 70% 80% 90%
Unpacking 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100%
Library Manager: ArduinoJson@6.21.5 has been installed!
Verbose mode can be enabled via `-v, --verbose` option
CONFIGURATION: https://docs.platformio.org/page/boards/espressif32/esp32-s3-devkitc-1.html
PLATFORM: Espressif 32 (6.6.0) > Espressif ESP32-S3-DevKitC-1-N8 (8 MB QD, No PSRAM)
HARDWARE: ESP32S3 240MHz, 320KB RAM, 8MB Flash
DEBUG: Current (esp-builtin) On-board (esp-builtin) External (cmsis-dap, esp-bridge, esp-prog, iot-bus-jtag, jlink, minimodule, olimex-arm-usb-ocd, olimex-arm-usb-ocd-h, olimex-arm-usb-tiny-h, olimex-jtag-tiny, tumpa)
PACKAGES:
 - framework-arduinoespressif32 @ 3.20014.231204 (2.0.14)
 - tool-esptoolpy @ 1.40501.0 (4.5.1)
 - toolchain-riscv32-esp @ 8.4.0+2021r2-patch5
 - toolchain-xtensa-esp32s3 @ 8.4.0+2021r2-patch5
LDF: Library Dependency Finder -> https://bit.ly/configure-pio-ldf
LDF Modes: Finder ~ chain, Compatibility ~ soft
[nanopb] Installing gRPC dependencies
Collecting grpcio-tools>=1.43.0
  Downloading grpcio_tools-1.76.0-cp312-cp312-manylinux2014_x86_64.manylinux_2_17_x86_64.whl.metadata (5.3 kB)
Requirement already satisfied: protobuf<7.0.0,>=6.31.1 in /home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages (from grpcio-tools>=1.43.0) (6.33.2)
Collecting grpcio>=1.76.0 (from grpcio-tools>=1.43.0)
  Downloading grpcio-1.76.0-cp312-cp312-manylinux2014_x86_64.manylinux_2_17_x86_64.whl.metadata (3.7 kB)
Collecting setuptools (from grpcio-tools>=1.43.0)
  Using cached setuptools-80.9.0-py3-none-any.whl.metadata (6.6 kB)
Requirement already satisfied: typing-extensions~=4.12 in /home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages (from grpcio>=1.76.0->grpcio-tools>=1.43.0) (4.15.0)
Downloading grpcio_tools-1.76.0-cp312-cp312-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (2.7 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2.7/2.7 MB 10.1 MB/s  0:00:00
Downloading grpcio-1.76.0-cp312-cp312-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (6.6 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 6.6/6.6 MB 25.8 MB/s  0:00:00
Using cached setuptools-80.9.0-py3-none-any.whl (1.2 MB)
Installing collected packages: setuptools, grpcio, grpcio-tools

Successfully installed grpcio-1.76.0 grpcio-tools-1.76.0 setuptools-80.9.0
[nanopb] No generation needed.
Found 41 compatible libraries
Scanning dependencies...
Dependency Graph
|-- NimBLE-Arduino @ 1.4.3
|-- Nanopb @ 0.4.91
|-- Adafruit DotStar @ 1.2.5
|-- ESPAsyncWebServer-esphome @ 3.4.0
|-- AsyncTCP-esphome @ 2.1.4
|-- ArduinoJson @ 6.21.5
|-- WiFi @ 2.0.0
|-- Update @ 2.0.0
|-- EcoFlowComm @ 1.0.0
|-- LittleFS @ 2.0.0
|-- Preferences @ 2.0.0
Building in release mode
Compiling .pio/build/esp32-s3-devkit-1/src/CmdUtils.cpp.o
Compiling .pio/build/esp32-s3-devkit-1/src/DeviceManager.cpp.o
Compiling .pio/build/esp32-s3-devkit-1/src/Display.cpp.o
In file included from .pio/libdeps/esp32-s3-devkit-1/NimBLE-Arduino/src/nimconfig.h:4,
                 from .pio/libdeps/esp32-s3-devkit-1/NimBLE-Arduino/src/NimBLEDevice.h:18,
                 from src/EcoflowESP32.h:13,
                 from src/DeviceManager.h:4,
                 from src/DeviceManager.cpp:11:
/home/jules/.platformio/packages/framework-arduinoespressif32/tools/sdk/esp32s3/qio_qspi/include/sdkconfig.h:768: warning: "CONFIG_BLUEDROID_ENABLED" redefined
 #define CONFIG_BLUEDROID_ENABLED CONFIG_BT_BLUEDROID_ENABLED

<command-line>: note: this is the location of the previous definition
Compiling .pio/build/esp32-s3-devkit-1/src/EcoflowCrypto.cpp.o
Compiling .pio/build/esp32-s3-devkit-1/src/EcoflowDataParser.cpp.o
Compiling .pio/build/esp32-s3-devkit-1/src/EcoflowESP32.cpp.o
In file included from .pio/libdeps/esp32-s3-devkit-1/NimBLE-Arduino/src/nimconfig.h:4,
                 from .pio/libdeps/esp32-s3-devkit-1/NimBLE-Arduino/src/NimBLEDevice.h:18,
                 from src/EcoflowESP32.h:13,
                 from src/EcoflowESP32.cpp:11:
/home/jules/.platformio/packages/framework-arduinoespressif32/tools/sdk/esp32s3/qio_qspi/include/sdkconfig.h:768: warning: "CONFIG_BLUEDROID_ENABLED" redefined
 #define CONFIG_BLUEDROID_ENABLED CONFIG_BT_BLUEDROID_ENABLED

<command-line>: note: this is the location of the previous definition
Compiling .pio/build/esp32-s3-devkit-1/src/EcoflowProtocol.cpp.o
Compiling .pio/build/esp32-s3-devkit-1/src/LightSensor.cpp.o
Compiling .pio/build/esp32-s3-devkit-1/src/LogBuffer.cpp.o
Compiling .pio/build/esp32-s3-devkit-1/src/OtaManager.cpp.o
Compiling .pio/build/esp32-s3-devkit-1/src/Stm32Serial.cpp.o
Compiling .pio/build/esp32-s3-devkit-1/src/WebServer.cpp.o
src/OtaManager.cpp: In member function 'bool OtaManager::beginStm32Ota(size_t)':
src/OtaManager.cpp:65:5: error: '_bytesWritten' was not declared in this scope
     _bytesWritten = 0;
     ^~~~~~~~~~~~~
src/OtaManager.cpp:65:5: note: suggested alternative: '_bytesSent'
     _bytesWritten = 0;
     ^~~~~~~~~~~~~
     _bytesSent
src/OtaManager.cpp: In member function 'bool OtaManager::writeStm32Data(uint8_t*, size_t)':
src/OtaManager.cpp:81:5: error: '_bytesWritten' was not declared in this scope
     _bytesWritten += written;
     ^~~~~~~~~~~~~
src/OtaManager.cpp:81:5: note: suggested alternative: '_bytesSent'
     _bytesWritten += written;
     ^~~~~~~~~~~~~
     _bytesSent
src/OtaManager.cpp: In member function 'bool OtaManager::endStm32Ota()':
src/OtaManager.cpp:137:5: error: 'sendStartCmd' was not declared in this scope
     sendStartCmd();
     ^~~~~~~~~~~~
src/OtaManager.cpp:137:5: note: suggested alternative: 'setState'
     sendStartCmd();
     ^~~~~~~~~~~~
     setState
src/OtaManager.cpp: At global scope:
src/OtaManager.cpp:144:6: error: no declaration matches 'void OtaManager::sendStartCmd()'
 void OtaManager::sendStartCmd() {
      ^~~~~~~~~~
src/OtaManager.cpp:144:6: note: no functions named 'void OtaManager::sendStartCmd()'
In file included from src/OtaManager.cpp:1:
src/OtaManager.h:9:7: note: 'class OtaManager' defined here
 class OtaManager {
       ^~~~~~~~~~
src/OtaManager.cpp:156:6: error: no declaration matches 'void OtaManager::sendDataCmd(uint32_t, uint8_t*, size_t)'
 void OtaManager::sendDataCmd(uint32_t offset, uint8_t* data, size_t len) {
      ^~~~~~~~~~
src/OtaManager.cpp:156:6: note: no functions named 'void OtaManager::sendDataCmd(uint32_t, uint8_t*, size_t)'
In file included from src/OtaManager.cpp:1:
src/OtaManager.h:9:7: note: 'class OtaManager' defined here
 class OtaManager {
       ^~~~~~~~~~
src/OtaManager.cpp: In member function 'void OtaManager::sendChunk()':
src/OtaManager.cpp:169:9: error: 'sendEndCmd' was not declared in this scope
         sendEndCmd(_crc); // Send CRC again as verification
         ^~~~~~~~~~
src/OtaManager.cpp: At global scope:
src/OtaManager.cpp:184:6: error: no declaration matches 'void OtaManager::sendEndCmd(uint32_t)'
 void OtaManager::sendEndCmd(uint32_t crc) {
      ^~~~~~~~~~
src/OtaManager.cpp:184:6: note: no functions named 'void OtaManager::sendEndCmd(uint32_t)'
In file included from src/OtaManager.cpp:1:
src/OtaManager.h:9:7: note: 'class OtaManager' defined here
 class OtaManager {
       ^~~~~~~~~~
src/OtaManager.cpp: In member function 'void OtaManager::update()':
src/OtaManager.cpp:203:17: error: 'sendStartCmd' was not declared in this scope
                 sendStartCmd();
                 ^~~~~~~~~~~~
src/OtaManager.cpp:203:17: note: suggested alternative: 'setState'
                 sendStartCmd();
                 ^~~~~~~~~~~~
                 setState
src/OtaManager.cpp:223:46: error: 'sendEndCmd' was not declared in this scope
             else if (_state == WAIT_END_ACK) sendEndCmd(_crc);
                                              ^~~~~~~~~~
*** [.pio/build/esp32-s3-devkit-1/src/OtaManager.cpp.o] Error 1
src/Stm32Serial.cpp: In member function 'void Stm32Serial::processPacket(uint8_t*, uint8_t)':
src/Stm32Serial.cpp:110:23: error: 'CMD_OTA_ACK' was not declared in this scope
     } else if (cmd == CMD_OTA_ACK) {
                       ^~~~~~~~~~~
src/Stm32Serial.cpp:110:23: note: suggested alternative: 'CMD_SET_AC'
     } else if (cmd == CMD_OTA_ACK) {
                       ^~~~~~~~~~~
                       CMD_SET_AC
src/Stm32Serial.cpp:116:23: error: 'CMD_OTA_NACK' was not declared in this scope
     } else if (cmd == CMD_OTA_NACK) {
                       ^~~~~~~~~~~~
src/Stm32Serial.cpp:116:23: note: suggested alternative: 'CMD_SET_AC'
     } else if (cmd == CMD_OTA_NACK) {
                       ^~~~~~~~~~~~
                       CMD_SET_AC
*** [.pio/build/esp32-s3-devkit-1/src/Stm32Serial.cpp.o] Error 1
========================= [FAILED] Took 108.27 seconds =========================
